# upgrade/legacy setup script

# used by 1.1.20

echo "Saving current directory as CURDIR: $ CURDIR=\$(pwd)"
CURDIR=$(pwd)
echo "Creating temporary working directory and saving location as TMPDIR: $ TMPDIR=$(mktemp -d)"
TMPDIR=$(mktemp -d)
echo "Going to temporary working directory: $ cd \$TMPDIR which is" $TMPDIR
cd $TMPDIR

# add bintray gpg key

curl https://bintray.com/user/downloadSubjectPublicKey?username=bintray | gpg --dearmor > bintray.gpg
sudo cp bintray.gpg /etc/apt/trusted.gpg.d/

# add bintray repo

sudo echo 'deb https://dl.bintray.com/whitewaterfoundry/ stable main' >> /etc/apt/sources.list

# add whitewater foundry gpg

sudo apt-get install wlinux-baseconfig wlinux-setup winux-wslu -y
sudo apt-get upgrade -y

echo "Returning to our original directory: $ cd $CURDIR"
cd $CURDIR
echo "Cleaning up temporary working directory: $ sudo rm -r $TMPDIR"
sudo rm -r $TMPDIR  # need to add sudo here because git clones leave behind write-protected files